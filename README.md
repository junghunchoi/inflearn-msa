학습순서
1) article
2) comment_V1 -> comment_V2
3) like

----
<h1>게시글(ariticle)</h1>

1. 비슷한 메소드는 파라미터 갯수차이로 클라이언트에서 구분하여 요청하도록 하자

2. from, of 와 같이 팩토리 메소드를 적극사용하자.

3. 무한 스크롤은 "<=" 연산자를 이용해서 구현이 가능하다.


4. 샤드에선 pk를 auto increment 를 사용해도 유일성이 보장되지 않는다.
또한, 클라이언트에 키를 노출하게 될 경우 보안적인 이슈가 있을 수 있다.
다만, 너무 큰 문자열을 사용하게 되면 인덱스의 크기가 커지고, 검색 속도가 느려질 수 있다.
절충안인 snowflake를 사용하자.


---
<h1>댓글(comment)</h1>
무한 depth 댓글

부모의 id를 참조하기 위해선 문자열로 저장해야한다.
예) 123|456|789 이런식으로 저장하고, split을 통해 파싱한다.

문자열로 구분했기에 경로 컬럼이 정렬되어 있고 부모 댓글로 순서대로 자식 댓글도 정렬이 되어있어 해당 부분만 조회하기 때문에
커버링 인덱스가 사용되어 많은양의 데이터에도 빠르게 조회가 가능하다.

![img_1.png](img_1.png)

---
좋아요를 테이블에서 관리하면 레코드에 락이 잡힐 여지가 크다.
그렇다고 타임아웃과 요청량에 제한을 둔다면 정상적인 기능에 문제가 생길 여지가 크다

그래서 좋아요를 레코드에 관리하지 않고, 독립적인 테이블로 분리하여 관리한다. 

---
2025-03-04
lock 별로 테스트를 돌려보고 상황별로 어떻게 다른지 확인해보고 적절한 것을 찾아야한다.
-> 낙관적락은 동시성이슈 때문에 정확하게 좋아요수가 오르지 않는다. 테스트코드를 확인해보자